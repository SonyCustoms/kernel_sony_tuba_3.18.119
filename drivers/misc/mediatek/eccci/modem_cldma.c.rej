--- drivers/misc/mediatek/eccci/modem_cldma.c
+++ drivers/misc/mediatek/eccci/modem_cldma.c
@@ -527,10 +534,15 @@ again:
 		port_recv_time = ((skb_alloc_time = sched_clock()) - port_recv_time);
 #endif
 		new_skb = NULL;
+new_skb_retry:
 		if (ret >= 0 || ret == -CCCI_ERR_DROP_PACKET) {
 			new_skb = ccci_alloc_skb(queue->tr_ring->pkt_size, !is_net_queue, blocking);
-			if (!new_skb)
+			if (!new_skb) {
 				CCCI_ERROR_LOG(md->index, TAG, "alloc skb fail on q%d\n", queue->index);
+				if (queue->index != 0)
+					msleep(100);
+				goto new_skb_retry;
+			}
 		}
 		if (new_skb) {
 			/* mark cldma_request as available */
@@ -3075,7 +3108,7 @@ static int md_cd_send_runtime_data(struct ccci_modem *md, unsigned int tx_ch, un
 	if (md->config.load_type < modem_ultg)
 		runtime->feature_4_val[1] = 0;
 	else
-		runtime->feature_4_val[1] = get_md_wm_id_map(md->config.load_type);
+		runtime->feature_4_val[1] = get_wm_bitmap_for_ubin();
 
 	/* CCCI debug */
 #if defined(FEATURE_SEQ_CHECK_EN) || defined(FEATURE_POLL_MD_EN)
