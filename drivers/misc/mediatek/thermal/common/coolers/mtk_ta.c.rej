--- drivers/misc/mediatek/thermal/common/coolers/mtk_ta.c
+++ drivers/misc/mediatek/thermal/common/coolers/mtk_ta.c
@@ -217,24 +245,21 @@ static void ta_nl_data_handler(struct sk_buff *skb)
 	data = NLMSG_DATA(nlh);
 
 	tad_msg = (struct tad_nl_msg_t *)data;
+	if (tad_msg->tad_ret_data_len >= TAD_NL_MSG_MAX_LEN) {
+		tsta_warn("[ta_nl_data_handler] tad_msg->=ad_ret_data_len=%d\n", tad_msg->tad_ret_data_len);
+		return;
+	}
 
 	size = tad_msg->tad_ret_data_len + TAD_NL_MSG_T_HDR_LEN;
 
 
-	/*tad_ret_msg = (struct tad_nl_msg_t *)vmalloc(size);*/
-	tad_ret_msg = vmalloc(size);
-	if (tad_ret_msg != NULL) {
-		memset(tad_ret_msg, 0, size);
 
-		atm_ctrl_cmd_from_user(data, tad_ret_msg);
-		ta_nl_send_to_user(pid, seq, tad_ret_msg);
-		tsta_dprintk("[ta_nl_data_handler] send to user space process done\n");
+	memset(&tad_ret_msg, 0, size);
 
-		vfree(tad_ret_msg);
+	atm_ctrl_cmd_from_user(data, &tad_ret_msg);
+	ta_nl_send_to_user(pid, seq, &tad_ret_msg);
+	tsta_dprintk("[ta_nl_data_handler] send to user space process done\n");
 
-	} else {
-		tsta_warn("[ta_nl_data_handler] vmalloc fail\n");
-	}
 
 }
 
