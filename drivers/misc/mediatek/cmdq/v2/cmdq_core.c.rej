--- drivers/misc/mediatek/cmdq/v2/cmdq_core.c
+++ drivers/misc/mediatek/cmdq/v2/cmdq_core.c
@@ -6270,6 +6318,7 @@ static int32_t cmdq_core_handle_wait_task_result_secure_impl(TaskStruct *pTask,
 	int32_t irqFlag = 0;
 	cmdqSecCancelTaskResultStruct result;
 	char parsedInstruction[128] = { 0 };
+	unsigned long flags;
 
 	/* Init default status */
 	status = 0;
@@ -6313,21 +6362,6 @@ static int32_t cmdq_core_handle_wait_task_result_secure_impl(TaskStruct *pTask,
 		/*     .reset CMDQ secure HW thread */
 		cmdq_sec_cancel_error_task_unlocked(pTask, thread, &result);
 
-		/* dump shared cookie */
-		CMDQ_VERBOSE
-		    ("WAIT: [2]secure path failed, pTask:%p, thread:%d, shared_cookie(%d, %d, %d)\n",
-		     pTask, thread,
-		     cmdq_core_get_secure_thread_exec_counter(12),
-		     cmdq_core_get_secure_thread_exec_counter(13),
-		     cmdq_core_get_secure_thread_exec_counter(14));
-
-		/* confirm pending IRQ first */
-		cmdq_core_handle_secure_thread_done_impl(thread, 0x01, &pTask->wakedUp);
-
-		/* check if this task has finished after handling pending IRQ */
-		if (TASK_STATE_DONE == pTask->taskState)
-			break;
-
 		status = -ETIMEDOUT;
 		throwAEE = true;
 		/* shall we pass the error instru back from secure path?? */
@@ -6353,6 +6389,7 @@ static int32_t cmdq_core_handle_wait_task_result_secure_impl(TaskStruct *pTask,
 		}
 		pThread->taskCount = 0;
 		pThread->waitCookie = pThread->nextCookie;
+		spin_unlock_irqrestore(&gCmdqExecLock, flags);
 	} while (0);
 
 	/* unlock cmdqSecLock */
@@ -6786,6 +6834,8 @@ static int32_t cmdq_core_exec_task_async_secure_impl(TaskStruct *pTask, int32_t
 		if (0 > status)
 			break;
 
+		spin_lock_irqsave(&gCmdqExecLock, flags);
+
 		/* update task's thread info */
 		pTask->thread = thread;
 		pTask->irqFlag = 0;
@@ -6804,6 +6854,8 @@ static int32_t cmdq_core_exec_task_async_secure_impl(TaskStruct *pTask, int32_t
 									  false);
 		}
 
+		spin_unlock_irqrestore(&gCmdqExecLock, flags);
+
 		pTask->trigger = sched_clock();
 
 		/* execute */
